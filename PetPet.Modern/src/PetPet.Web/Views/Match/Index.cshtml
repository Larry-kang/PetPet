@model List<PetPet.Infrastructure.Services.MatchResultDto>
@{
    ViewData["Title"] = "é…å°å°ˆå€";
}

<div class="container py-5">
    <div class="text-center mb-5">
        <h1 class="display-4 fw-bold text-white" style="text-shadow: 0 2px 4px rgba(0,0,0,0.2);">ğŸ’˜ ç·£åˆ†åŒ¹é…</h1>
        <p class="text-white-50">ç‚ºæ‚¨çš„æ¯›å°å­©å°‹æ‰¾æœ€ä½³ç©ä¼´ï¼</p>
    </div>

    @if (!Model.Any())
    {
        <div class="glass-card text-center p-5">
            <h3>ğŸ˜” ç›®å‰æ²’æœ‰é©åˆçš„é…å°å°è±¡</h3>
            <p>è«‹ç¨å¾Œå†ä¾†ï¼Œæˆ–æ“´å¤§æ‚¨çš„æœå°‹ç¯„åœã€‚</p>
        </div>
    }
    else
    {
        <div class="row g-4">
            @foreach (var match in Model)
            {
                <div class="col-md-6 col-lg-4">
                    <div class="glass-card h-100 p-0 overflow-hidden position-relative">
                        <!-- Match Score Badge -->
                        <div class="position-absolute top-0 end-0 m-3 badge rounded-pill bg-danger fs-5 shadow">
                            @match.Score% é€Ÿé…
                        </div>

                        <!-- Photo -->
                        <div class="ratio ratio-4x3">
                             <img src="@(string.IsNullOrEmpty(match.TargetMember.Photo) ? "/images/default-user.png" : match.TargetMember.Photo)" 
                                  class="object-fit-cover" alt="@match.TargetMember.Name">
                        </div>

                        <div class="p-4 text-center">
                            <h3 class="fw-bold">@match.TargetMember.Name</h3>
                            
                            @if (match.PrimaryPet != null)
                            {
                                <p class="text-muted mb-2">
                                    <span class="badge bg-info text-dark">Variety: @match.PrimaryPet.VarietyId</span>
                                    <span>@(match.TargetMember.CityId == 1 ? "å°åŒ—" : "å…¶ä»–")</span>
                                </p>
                            }

                            <!-- Reasons -->
                            <div class="mb-4">
                                @foreach (var reason in match.MatchReasons)
                                {
                                    <span class="badge bg-success bg-opacity-75 me-1">@reason</span>
                                }
                            </div>

                            <div class="d-grid gap-2">
                                <a href="/Chat/Index?with=@match.TargetMember.Email" class="btn btn-primary rounded-pill">
                                    ğŸ’¬ ç™¼èµ·èŠå¤©
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>
